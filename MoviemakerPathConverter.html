<html>
  <head>
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
   <title>MoviemakerPathConverter</title>
  </head>
  <body>
   <h1>
     MoviemakerPathConverter<small>by simonlaux.de</small>
    </h1>
   <hr>
    <div class="container">
      
      <div id="dropzone" style="background:grey;border: 6px solid;border-radius:10px;width:100%;height:30vw">
      <!-- <input type="file" style="width:100%;height:100%"> -->
      </div>
      <div id="list">
        
      </div>
    </div>
  </body>
   <script>
     var WorkOnFile;
     var FileAsText="";
    function searchPaths(f){
      var reader = new FileReader();
      reader.readAsText(f,"UTF-8");
      reader.onload = function(e) {
               FileAsText=reader.result;
      var path = new RegExp(atob("KCIoKFthLXpBLVpdOil8KFxcXFxbXi9cXDpcKlw/IiI8Plx8XSsoXFxbYS16QS1aXVwkKT8pKVxcKFteL1xcOlwqXD8iIjw+XHxdK1xcKSpbXi9cXDpcKlw/IiI8Plx8XSsoXC5bXi9cXDpcKlw/IiI8Plx8XStbXi9cXDpcKlw/IiI8Plx8XHNdKT8iKXwoKChbYS16QS1aXTopfChcXFxcW14vXFw6XCpcPyIiPD5cfFxzXSsoXFxbYS16QS1aXVwkKT8pKVxcKFteL1xcOlwqXD8iIjw+XHxcc10rXFwpKlteL1xcOlwqXD8iIjw+XHxcc10rKFwuW2EtekEtWjAtOV0rKT8p"), "img");
      FileAsText.match(path).forEach(function(entry) {
    console.log(entry); 
            
});}
  
    }
    function handleFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();

    var files = evt.dataTransfer.files; // FileList object.

    // files is a FileList of File objects. List some properties.
      var eins=false;
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
      var string = escape(f.name),
    substring = "wlmp";
      if (!(string.indexOf(substring) > -1)) {
        continue;
      }
      if (eins) {
        continue;
      }
          eins=true;
      output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
                  f.size, ' bytes, last modified: ',
                  f.lastModifiedDate.toLocaleDateString(), '</li>');
         WorkOnFile=f;searchPaths(f);
      
    }
    document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
  }

  function handleDragOver(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
  }

  // Setup the dnd listeners.
  var dropZone = document.getElementById('dropzone');
  dropZone.addEventListener('dragover', handleDragOver, false);
  dropZone.addEventListener('drop', handleFileSelect, false);
    </script>
</html>